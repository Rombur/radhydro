\documentclass[letterpaper]{report}
\usepackage{amsmath}
\usepackage{array}
\usepackage{color}
\usepackage{graphicx}
\usepackage{float} % utiliser H pour forcer a mettre l'image ou on veut
\usepackage{lscape} % utilisation du mode paysage
\usepackage{mathbbol} % permet d'avoir le vrai symbol pour les reels grace a mathbb
\usepackage{enumerate} % permet d'utiliser enumerate
\usepackage{moreverb} % permet d'utiliser verbatimtab : conservation la tabulation
\usepackage{stmaryrd} % permet d'utiliser \llbrackedt et \rrbracket : double crochet
\usepackage[noabbrev]{cleveref} % permet d'utiliser cref and Cref
\usepackage{caption} % permet d'utiliser subcaption
\usepackage{subcaption} % permet d'utiliser subfigure, subtable, etc
\usepackage[margin=1.in]{geometry} % controle les marges du document


\newcommand\bn{\boldsymbol{\nabla}}
\newcommand\bo{\boldsymbol{\Omega}}
\newcommand\br{\mathbf{r}}
\newcommand\la{\left\langle}
\newcommand\ra{\right\rangle}
\newcommand\bs{\boldsymbol}
\newcommand\red{\textcolor{red}}
\newcommand\ldb{\{\!\!\{}
\newcommand\rdb{\}\!\!\}}
\newcommand\llb{\llbracket}
\newcommand\rrb{\rrbracket}

\renewcommand{\(}{\left(}
\renewcommand{\)}{\right)}
\renewcommand{\[}{\left[}
\renewcommand{\]}{\right]}


\setcounter{secnumdepth}{3}

\begin{document}
\title{Radiation Hydrodynamic}
\author{Bruno Turcksin} 
\date{}
\maketitle

\chapter{Equations}
In this section, we will develop the equations for radiation hydrodynamics and
their discretization.
\section{Hydrodynamic}
First, we start with hydrodynamic equations.
\subsection{Continuous equations}
We want to solve the Euler equations:
\begin{align}
  &\frac{\partial \rho}{\partial t} + \bn (\rho \bs{u}) = 0 \label{mass},\\
  &\frac{\partial \rho \bs{u}}{\partial t} + \bn (\rho\bs{u}\otimes\bs{u}) + \bn p =
  F \label{momentum},\\
  &\frac{\partial}{\partial t}\(\rho e +\frac{1}{2}\rho u^2\) +
  \bn\(\rho\bs{u}e + \frac{1}{2}\rho \bs{u} u^2+p\bs{u}\) = \rho q +\bs{u}F
  \label{energy},
\end{align}
where:
\begin{itemize}
  \item $\rho$ is the density,
  \item $t$ is the time,
  \item $\bs{u}$ is the speed,
  \item $\bs{u}\otimes\bs{u}$ is a tensor, the divergence is taken by assigning first
  1 to the second index, and forming the ordinary divergence of
  $\rho\bs{u}u_1$, then repeating for index 2 and index 3,
  \item $p$ is the pressure,
  \item $F$ is a body force,
  \item $e$ is the internal energy,
  \item $q$ is an external source of heat.
\end{itemize}
\Cref{mass} is the mass conservation equation, \cref{momentum} is the momentum
conservation equation, and \cref{energy} is the energy conservation equation.
The Euler equations describe an ideal fluid, i.e. with no viscosity and no heat
conduction. These equations allow shocks.
\subsection{Discretization}
Major discretizations:
\begin{description}
  \item[Lagrangian:] the mesh follows the material. This is very efficient in
  one dimension but for multidimensional problems, the mesh can be too
  distorted and new it is necessary to remesh the domain.
  \item[Eulerian:] the mesh is fixed at the beginning of the calculation.
  Adaptive Mesh Refinement (AMR) is often necessary to have an accurate
  results.
  \item[Arbitrary Lagrangian-Eulerian (ALE):] the mesh moves at a given speed.
  \item[Smoothed particle hydrodynamics (SPH):] there is no mesh. SPH looks
  like a Monte-Carlo method but initial particles are not selected randomly.
  The method is first order.
\end{description}
In the rest of this paper, we will focus on Eulerian discretization.
\subsubsection{Lagrangian plus advection}
A time step consists of a ''Lagrangian'' step followed by an advection step.
The idea is the same than operator split: for each of these substeps just part
of the expression for the time derivative of each  is applied. The unknowns
$\rho$, $\rho\bs{u}$, and $\rho e$ are updated using those parts of their time
derivatives, and the updated values are the starting point for the next
partial time step. For the Lagrangian step the density is left alone, the
momentum density is updated using just the pressure gradient, after which a
new flow velocity is calculated by division. The velocity and momentum density
components are centered in time at $t_{n+1/2}$. The new velocities are used to
calculated $\bn\bs{u}$ and the internal energy density is updated using just
the first term on the right-hand side of \cref{3.22}. That completes the
Lagrangian step.

Equations for the Lagrangian step:
\begin{align}
  &\frac{\partial \rho}{\partial t} = -\bn (\rho \bs{u}),\\
  &\frac{\partial \rho \bs{u}}{\partial t} = -\bn p - \bn(\rho
  \bs{u}\otimes\bs{u}),\\
  &\frac{\partial \rho e}{\partial t} = -p\bn\bs{u} - \bn (\rho e \bs{u})
  \label{3.22}.
\end{align}
Equations for the advection step:
\begin{align}
  &\frac{d}{dt}(\rho V) = -\int_S \rho \bs{u}d\br,
  &\frac{d}{dt}(\rho \bs{u}V') = -\int_{S'} \rho \bs{u}\otimes\bs{u} d\br,
  &\frac{d}{dt}(\rho e V) = -\int_S \rho \bs{u}e d\br.
\end{align}
$V$ is a zonal volume and $V'$ is a dual zone volume, since the velocity
components are staggered in space from the quantities like density and
internal energy. The surface $S$ and $S'$ represent the boundaries of $V$ and
$V'$.
\subsubsection{Godunov's methods}
Godunov's methods are finite-volume methods. First, we write the Euler
equations as:
\begin{equation}
  \frac{\partial U}{\partial t} + \bn \bs{F}(U)=0.
\end{equation}
The vector $U$ contains the conserved densities $\rho$, $\rho u_x$, $\rho
u_y$, and $\rho e + \rho u^2/2$. The components of the flux vector are $\rho
\bs{u}$, $\rho \bs{u}u_x+ p\bs{e}_x$, $\rho \bs{u} u_y+p\bs{e}_y$, and $\rho
\bs{u} e +\rho \bs{u} u^2/2+p\bs{u}$. By averaging over a volume $V$ and over
a time interval $[t_n,t_{n+1}]$, we get:
\begin{equation}
  V\frac{\Delta \la U\ra}{\Delta t} = -\int_S\la \bs{F} \ra \cdot \bs{n} d\br.
\end{equation}
The expression $\la U \ra$ represents the zone average $U$ at the beginning
and the end of the time step; these are our unknowns. The quantity  $\la
\bs{F} \ra \cdot \bs{n}$ represents the flux of a conserved quantity through
the edge of a zone averaged over the time step. If we can construct accurate
values of these edge fluxes from the beginning-of-step values of $\la U \ra$,
then the advanced values follow immediately. From the components of $U$ it is
simple arithmetic to find $\bs{u}$ and $e$, and then the pressure can be
calculated. At the beginning of the time step we imagine that each zone is
uniform, with its average fluid quantities $\rho$, $\bs{u}$, and $p$. At an
interface between two zones there will thus be a discontinuity. The name for
the situation in which two regions of constant fluid properties meet at a
discontinuity is a Riemann problem. At the next instant this discontinuity
will be resolved into a pair of shocks, a shock and a rarefaction wave, or two
rarefaction waves, one traveling into each of the two zones. At the material
interface, which at the beginning of the time step coincides with the zone
boundary, there will be continuous values of pressure and velocity. Godunov's
method is to use these conditions, derived from the solution of the Riemann
problem, to evaluate the edge fluxes, them to use the conservation law to
update the conserved quantities to the next time step.
\subsubsection{WENO, TVD, TVB}
\begin{description}
  \item[WENO] stands for weighted essentially non-oscillatory. WENO consists
  of having different discretizations of the same cells and using a linear
  combination of them to have a non-oscillatory solution.
  \item[TVD] stands for total variation diminishing. It means the spatial
  fluctuation in the end of the time step cannot be larger than it was at the
  beginning of the time step.
  \item[TVB] stands for total variation bounded. It means that, while the
  fluctuation may grow, it will always be less than some fixed bound.
\end{description}

\section{Radiative transfer}
The equation is the ''usual'' equation:
\begin{equation}
  \frac{1}{c}\frac{\partial I}{\partial t} + \bo\cdot \bn I + \Sigma_t I =
  \int_{4\pi} \Sigma_s(\bo\cdot\bo') I\ d\bo' + Q,
\end{equation}
with $I$ is the intensity. Instead of using the energy as variable, we use the
frequency $\nu$.  We also define:
\begin{itemize}
  \item the energy density:
  \begin{equation}
    E = \frac{1}{c}\int_{4\pi} I\ d\bo.
  \end{equation}
  \item the flux:
  \begin{equation}
    \bs{F} = \int_{4\pi} \bo I\ d\bo.
  \end{equation}
  \item the pressure:
  \begin{equation}
    P = \frac{1}{c}\int_{4\pi}\bo\bo I\ d\bo.
  \end{equation}
\end{itemize}

\section{Radiative hydrodynamic}
\subsection{Coupling terms in Euler's equation}
First, we need to define:
\begin{align}
  &g^0 = \int d\nu\int_{4\pi} d\bo (S-\Sigma_a I),\\
  &\bs{g} = \frac{1}{c}\int d\nu \int_{4\pi} d\bo \bo(S-\Sigma_a I).
\end{align}.
We should put the negatives of these on the right-hand side of the material
energy and momentum equations:
\begin{align}
  &\frac{\partial}{\partial t}\(\rho e + \frac{1}{2}\rho u^2\) + \bn \(\rho
  \bs{u} e + \frac{1}{2} \rho \bs{u}u^2\) = - g^0,\\
  & \frac{\partial \rho \bs{u}}{\partial t} + \bn(\rho\bs{u}\otimes\bs{u})+
  \bn p = 0\bs{g}.
\end{align}
We have left out the nonradiative body force and heat deposition terms for
simplicity. Summing the frequency-integrated radiation moment equations and
the material equations gives the overall conservation laws:
\begin{align}
  &\frac{\partial}{\partial t}\(\rho e + E + \frac{1}{2}\rho u^2\) + \bn \(\rho
  \bs{u} e + \frac{1}{2} \rho \bs{u}u^2 + \bs{F}\) = 0,\\
  & \frac{\partial}{\partial t}\(\rho \bs{u} + \frac{\bs{F}}{c^2}\) +
  \bn(\rho\bs{u}\otimes\bs{u}+ P) + \bn p = 0.
\end{align}


\chapter{Tests}

\chapter{State-of-the-art codes}

\chapter{Project}
entropy viscosity, JFNK, AMR, Sn, (SD(I))RK methods

\end{document}
