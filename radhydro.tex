\documentclass[letterpaper]{report}
\usepackage{amsmath}
\usepackage{array}
\usepackage{color}
\usepackage{graphicx}
\usepackage{float} % utiliser H pour forcer a mettre l'image ou on veut
\usepackage{lscape} % utilisation du mode paysage
\usepackage{mathbbol} % permet d'avoir le vrai symbol pour les reels grace a mathbb
\usepackage{enumerate} % permet d'utiliser enumerate
\usepackage{moreverb} % permet d'utiliser verbatimtab : conservation la tabulation
\usepackage{stmaryrd} % permet d'utiliser \llbrackedt et \rrbracket : double crochet
\usepackage[noabbrev]{cleveref} % permet d'utiliser cref and Cref
\usepackage{caption} % permet d'utiliser subcaption
\usepackage{subcaption} % permet d'utiliser subfigure, subtable, etc
\usepackage[margin=1.in]{geometry} % controle les marges du document


\newcommand\bn{\boldsymbol{\nabla}}
\newcommand\bo{\boldsymbol{\Omega}}
\newcommand\br{\mathbf{r}}
\newcommand\la{\left\langle}
\newcommand\ra{\right\rangle}
\newcommand\bs{\boldsymbol}
\newcommand\red{\textcolor{red}}
\newcommand\ldb{\{\!\!\{}
\newcommand\rdb{\}\!\!\}}
\newcommand\llb{\llbracket}
\newcommand\rrb{\rrbracket}

\renewcommand{\(}{\left(}
\renewcommand{\)}{\right)}
\renewcommand{\[}{\left[}
\renewcommand{\]}{\right]}


\setcounter{secnumdepth}{3}

\begin{document}
\title{Radiation Hydrodynamic}
\author{Bruno Turcksin} 
\date{}
\maketitle

\chapter{Equations}
In this section, we will develop the equations for radiation hydrodynamics and
their discretization.
\section{Hydrodynamic}
First, we start with hydrodynamic equations.
\subsection{Continuous equations}
We want to solve the Euler equations:
\begin{align}
  &\frac{\partial \rho}{\partial t} + \bn (\rho \bs{u}) = 0 \label{mass},\\
  &\frac{\partial \rho \bs{u}}{\partial t} + \bn (\rho\bs{u}\otimes\bs{u}) + \bn p =
  F \label{momentum},\\
  &\frac{\partial}{\partial t}\(\rho e +\frac{1}{2}\rho u^2\) +
  \bn\(\rho\bs{u}e + \frac{1}{2}\rho \bs{u} u^2+p\bs{u}\) = \rho q +\bs{u}F
  \label{energy},
\end{align}
where:
\begin{itemize}
  \item $\rho$ is the density,
  \item $t$ is the time,
  \item $\bs{u}$ is the speed,
  \item $\bs{u}\otimes\bs{u}$ is a tensor, the divergence is taken by assigning first
  1 to the second index, and forming the ordinary divergence of
  $\rho\bs{u}u_1$, then repeating for index 2 and index 3,
  \item $p$ is the pressure,
  \item $F$ is a body force,
  \item $e$ is the internal energy,
  \item $q$ is an external source of heat.
\end{itemize}
\Cref{mass} is the mass conservation equation, \cref{momentum} is the momentum
conservation equation, and \cref{energy} is the energy conservation equation.
The Euler equations describe an ideal fluid, i.e. with no viscosity and no heat
conduction. These equations allow shocks.
\subsection{Discretization}
Major discretizations:
\begin{description}
  \item[Lagrangian:] the mesh follows the material. This is very efficient in
  one dimension but for multidimensional problems, the mesh can be too
  distorted and new it is necessary to remesh the domain.
  \item[Eulerian:] the mesh is fixed at the beginning of the calculation.
  Adaptive Mesh Refinement (AMR) is often necessary to have an accurate
  results.
  \item[Arbitrary Lagrangian-Eulerian (ALE):] the mesh moves at a given speed.
  \item[Smoothed particle hydrodynamics (SPH):] there is no mesh. SPH looks
  like a Monte-Carlo method but initial particles are not selected randomly.
  The method is first order.
\end{description}
In the rest of this paper, we will focus on Eulerian discretization.
\subsubsection{Lagrangian plus advection}
A time step consists of a ''Lagrangian'' step followed by an advection step.
The idea is the same than operator split: for each of these substeps just part
of the expression for the time derivative of each  is applied. The unknowns
$\rho$, $\rho\bs{u}$, and $\rho e$ are updated using those parts of their time
derivatives, and the updated values are the starting point for the next
partial time step. For the Lagrangian step the density is left alone, the
momentum density is updated using just the pressure gradient, after which a
new flow velocity is calculated by division. The velocity and momentum density
components are centered in time at $t_{n+1/2}$. The new velocities are used to
calculated $\bn\bs{u}$ and the internal energy density is updated using just
the first term on the right-hand side of \cref{3.22}. That completes the
Lagrangian step.

Equations for the Lagrangian step:
\begin{align}
  &\frac{\partial \rho}{\partial t} = -\bn (\rho \bs{u}),\\
  &\frac{\partial \rho \bs{u}}{\partial t} = -\bn p - \bn(\rho
  \bs{u}\otimes\bs{u}),\\
  &\frac{\partial \rho e}{\partial t} = -p\bn\bs{u} - \bn (\rho e \bs{u})
  \label{3.22}.
\end{align}
Equations for the advection step:
\begin{align}
  &\frac{d}{dt}(\rho V) = -\int_S \rho \bs{u}d\br,
  &\frac{d}{dt}(\rho \bs{u}V') = -\int_{S'} \rho \bs{u}\otimes\bs{u} d\br,
  &\frac{d}{dt}(\rho e V) = -\int_S \rho \bs{u}e d\br.
\end{align}
$V$ is a zonal volume and $V'$ is a dual zone volume, since the velocity
components are staggered in space from the quantities like density and
internal energy. The surface $S$ and $S'$ represent the boundaries of $V$ and
$V'$.
\subsubsection{Godunov's methods}
Godunov's methods are finite-volume methods. First, we write the Euler
equations as:
\begin{equation}
  \frac{\partial U}{\partial t} + \bn \bs{F}(U)=0.
\end{equation}
The vector $U$ contains the conserved densities $\rho$, $\rho u_x$, $\rho
u_y$, and $\rho e + \rho u^2/2$. The components of the flux vector are $\rho
\bs{u}$, $\rho \bs{u}u_x+ p\bs{e}_x$, $\rho \bs{u} u_y+p\bs{e}_y$, and $\rho
\bs{u} e +\rho \bs{u} u^2/2+p\bs{u}$. By averaging over a volume $V$ and over
a time interval $[t_n,t_{n+1}]$, we get:
\begin{equation}
  V\frac{\Delta \la U\ra}{\Delta t} = -\int_S\la \bs{F} \ra \cdot \bs{n} d\br.
\end{equation}
The expression $\la U \ra$ represents the zone average $U$ at the beginning
and the end of the time step; these are our unknowns. The quantity  $\la
\bs{F} \ra \cdot \bs{n}$ represents the flux of a conserved quantity through
the edge of a zone averaged over the time step. If we can construct accurate
values of these edge fluxes from the beginning-of-step values of $\la U \ra$,
then the advanced values follow immediately. From the components of $U$ it is
simple arithmetic to find $\bs{u}$ and $e$, and then the pressure can be
calculated. At the beginning of the time step we imagine that each zone is
uniform, with its average fluid quantities $\rho$, $\bs{u}$, and $p$. At an
interface between two zones there will thus be a discontinuity. The name for
the situation in which two regions of constant fluid properties meet at a
discontinuity is a Riemann problem. At the next instant this discontinuity
will be resolved into a pair of shocks, a shock and a rarefaction wave, or two
rarefaction waves, one traveling into each of the two zones. At the material
interface, which at the beginning of the time step coincides with the zone
boundary, there will be continuous values of pressure and velocity. Godunov's
method is to use these conditions, derived from the solution of the Riemann
problem, to evaluate the edge fluxes, them to use the conservation law to
update the conserved quantities to the next time step.
\subsubsection{WENO, TVD, TVB}
\begin{description}
  \item[WENO] stands for weighted essentially non-oscillatory. WENO consists
  of having different discretizations of the same cells and using a linear
  combination of them to have a non-oscillatory solution.
  \item[TVD] stands for total variation diminishing. It means the spatial
  fluctuation in the end of the time step cannot be larger than it was at the
  beginning of the time step.
  \item[TVB] stands for total variation bounded. It means that, while the
  fluctuation may grow, it will always be less than some fixed bound.
\end{description}

\section{Radiative transfer}
The equation is the ''usual'' equation:
\begin{equation}
  \frac{1}{c}\frac{\partial I}{\partial t} + \bo\cdot \bn I + \Sigma_t I =
  \int_{4\pi} \Sigma_s(\bo\cdot\bo') I\ d\bo' + Q,
\end{equation}
with $I$ is the intensity. Instead of using the energy as variable, we use the
frequency $\nu$.  We also define:
\begin{itemize}
  \item the energy density:
  \begin{equation}
    E = \frac{1}{c}\int_{4\pi} I\ d\bo.
  \end{equation}
  \item the flux:
  \begin{equation}
    \bs{F} = \int_{4\pi} \bo I\ d\bo.
  \end{equation}
  \item the pressure:
  \begin{equation}
    P = \frac{1}{c}\int_{4\pi}\bo\bo I\ d\bo.
  \end{equation}
\end{itemize}
\subsection{Comoving frame}
We use the following definition:
\begin{equation}
  \Sigma_a = k_{\nu}
\end{equation}
Doppler and aberration relations:
\begin{align}
  \nu &= \nu_{(0)} \gamma_u \(1+\frac{\bo_{(0)}\cdot \bs{u}}{c}\),\\
  \bo &= \frac{\gamma_u\frac{\bs{u}}{c}+\bo_{(0)}+(\gamma_u-1)(\bo_{(0)}\cdot
  \bs{u})\bs{u}/u^2}{\gamma_u(1+\bo_{(0)}\cdot \bs{u}/c)},
\end{align}
where $\gamma_u = \frac{1}{\sqrt{1-\frac{u^2}{c^2}}}$. A fixed $\bs{r}_0$ is 
moving with the velocity $\bs{u}$ in the $(t,\bs{r})$ coordinates. For small 
values of the relative velocity $\bs{u}$ of the two frames these relations
simplify considerably. In that case we can neglect all the $u^2/c^2$ terms,
which means that $\gamma_u$ can be replaced by 1. Therefore:
\begin{align}
  \nu &= \nu_{(0)}\(1+\frac{\bo_{(0)}\cdot \bs{u}}{c}\),\\
  \bo &= \frac{\bo_{(0)} + \bs{u}/c}{1+\bo_{(0)}\cdot \bs{u}/c}.
\end{align}
Discarding all the terms that are $O(u^2/c^2)$ or higher. This result is
obtained:
\begin{equation}
  \begin{split}
    &\(1+\frac{\bo_{(0)}}{c}\cdot\bs{u}\)\(\frac{1}{c} \frac{\partial
    I^{(0)}}{\partial t}+\frac{\bs{u}}{c}\cdot\bn I^{(0)}\) + \bo_{(0)} \cdot \bn
    I^{(0)}\\
    &-\frac{\nu_{(0)}}{c}\(\frac{\bs{a}}{c}+\bo_{(0)}\cdot\bn\bs{u}\) \cdot
    \bn_{\nu_{(0)}\bo_{(0)}}I^{(0)}\\
    &+\frac{3}{c}\(\frac{\bo_{(0)}\cdot\bs{a}}{c} + \bo_{(0)}\cdot \bn
    \bs{u}\cdot \bo_{(0)}\) I^{(0)} = j^{(0)} - k^{(0)}I^{(0)}.
  \end{split}
  \label{6.39}
\end{equation}
For simplicity here and below, the subscripts indicating that all the
frequency-dependent quantities in the comoving frame are evaluated at
$\nu_{(0)}$ have been omitted. There are two features of this equation in
which we should comment first. The term $\bo_{(0)}\cdot \bs{u}/c$ in the
coefficient of the first term would go away if the transformation from the
fixed frame to the comoving frame had really been a Lorentz transformation,
since a spatial derivative at constant time in the fixed frame owing to the
relativity of time. But we are not altering the time coordinate in our
procedure, so this term is left over. The terms involving the acceleration,
$\bs{a}$, arise from $\frac{\partial \bs{u}}{\partial t}$. The actual
acceleration is $\frac{\partial \bs{u}}{\partial t} + \bs{u}\cdot\bn\bs{u}$,
of course, so we might wonder about the other piece. But the extra parts would
bring in terms that are of order $u^2/c^2$, and all such terms have been
discarded. It is our opinion that the acceleration terms, as well as the
$\bo_{(0)}\cdot \frac{\bs{u}}{c}$ part of the coefficient of the first term
should be discarded. The reasoning is as follows. In a fluid flow problem the
time derivative and the flow derivative $\bs{u}\cdot\bn$ are generally of the
same order of magnitude. If the acceleration terms above are ordered in this
way then all of them are seen to be of order $u^2/c^2$ compared with the
dominant terms, and may be discarded. The same is true of the
$\bo_{(0)}\cdot\frac{\bs{u}}{c}$ term multiplying $\frac{\partial
I^{(0)}}{\partial t}$.

We suggest that \cref{6.39} be retained for those problems involving
nonrelativistic velocities that evolve on a light-transit scale, and we
simplify this equation by dropping the subject the subject terms for problems
with the fluid-flow time scale. Carrying out the simplification leads to:
\begin{equation}
  \begin{split}
    &\frac{1}{c}\frac{D I^{(0)}}{Dt} +\bo_{(0)}\cdot\bn
    I^{(0)}-\frac{\nu_{(0)}}{c}\bo_{(0)}\cdot\bn\bs{u}\cdot
    \bn_{\nu_{(0)}\bo_{(0)}}I^{(0)}\\
    &+\frac{3}{c}\bo_{(0)}\cdot\bn\bs{u}\cdot\bo_{(0)}I^{(0)} =
    j^{(0)}-k^{(0)}I^{(0)}
  \end{split}
\end{equation}
where $\frac{D}{Dt}=\frac{\partial}{\partial t}+\bs{u}\cdot\bn$.

\section{Radiative hydrodynamic}
\subsection{Coupling terms in Euler's equation}
First, we need to define:
\begin{align}
  &g^0 = \int d\nu\int_{4\pi} d\bo (S-\Sigma_a I),\\
  &\bs{g} = \frac{1}{c}\int d\nu \int_{4\pi} d\bo \bo(S-\Sigma_a I).
\end{align}.
We should put the negatives of these on the right-hand side of the material
energy and momentum equations:
\begin{align}
  &\frac{\partial}{\partial t}\(\rho e + \frac{1}{2}\rho u^2\) + \bn \(\rho
  \bs{u} e + \frac{1}{2} \rho \bs{u}u^2\) = - g^0,\\
  & \frac{\partial \rho \bs{u}}{\partial t} + \bn(\rho\bs{u}\otimes\bs{u})+
  \bn p = 0\bs{g}.
\end{align}
We have left out the nonradiative body force and heat deposition terms for
simplicity. Summing the frequency-integrated radiation moment equations and
the material equations gives the overall conservation laws:
\begin{align}
  &\frac{\partial}{\partial t}\(\rho e + E + \frac{1}{2}\rho u^2\) + \bn \(\rho
  \bs{u} e + \frac{1}{2} \rho \bs{u}u^2 + \bs{F}\) = 0,\\
  & \frac{\partial}{\partial t}\(\rho \bs{u} + \frac{\bs{F}}{c^2}\) +
  \bn(\rho\bs{u}\otimes\bs{u}+ P) + \bn p = 0.
\end{align}

\subsection{Comoving frame}
$g^0$ and $\bs{g}$ are exactly as given earlier. The Lorentz transformation to
first order in $u/c$ is:
\begin{align}
  &g^0 = g_{(0)}^0 + \frac{\bs{u}}{c^2}\cdot \bs{g}_{(0)}, \label{6.35}\\
  &\bs{g} = \bs{g}_{(0)} + \bs{u} g_{(0)}^0. \label{6.36}
\end{align}
The second term on the right-hand side of the $\bs{g}$ equation is another of
those pesky ones that does not have an analog in nonrelativistic mechanics. It
comes about because the addition of energy increase the relativistic mass
density and therefore also the relativistic momentum density. When we treat
the material fluid nonrelativistically there is no similar term in the
material density. When we treat the material fluid nonrelativistically there
is no similar term in the material momentum equation to compensate this one.
Fortunately, it is small and we can discard it or hide it somewhere. The
velocity term in the $g^0$ equation does have a nonrelativistic meaning. It is
the rate of doing work by the force exerted on the radiation by the matter.
The components of $g^{\mu}$ in the fluid frame are easily found from the
atomic properties of the matter, without the need for Doppler and aberration
transformations. Furthermore, we can almost always assume isotropy of the
absorptivity and emissivity in the fluid frame. With that assumption, we
obtain:
\begin{align}
  &g_{(0)}^0 = \int d\nu\ \(4\pi
  j_{\nu}^{(0)}-\Sigma_{a,\nu}^{(0)}cE_{\nu}^{(0)}\), \label{6.37}\\
  &\bs{g}_{(0)} = -c \int d\nu\ \Sigma_{a,\nu}^{(0)}\bs{F}_{\nu}^{(0)}.
  \label{6.38} 
\end{align}
These are the same expressions that we used for the right-hand sides of the
fixed frame movement equations earlier, only repeated here using the
fluid-frame absorptivity and emissivity and the fluid-frame radiation moments.
The important difference is that the earlier fixed-frame expressions are wrong
if there is an appreciable velocity while the fluid-frame expressions are
correct as long as the velocity is non-relativistic. The components $g^0$ and
$\bs{g}$ obtained by substituting \cref{6.37,6.38} into \cref{6.35,6.36} give
the correct quantities to put in the right-hand sides of the fixed-frame
moments equations.

\chapter{Tests}

\chapter{State-of-the-art codes}

\chapter{Project}
entropy viscosity, JFNK, AMR, Sn, (SD(I))RK methods

\end{document}
